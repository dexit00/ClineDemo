# ECShop - ローカル環境セットアップ手順書

## 概要

このドキュメントは、ECShopプロジェクトを新人開発者がローカル環境で起動するための詳細な手順書です。
初回セットアップから日常的な開発作業まで、段階的に説明します。

## 目次

1. [必要な環境・ツール](#必要な環境ツール)
2. [環境構築手順](#環境構築手順)
3. [プロジェクトセットアップ](#プロジェクトセットアップ)
4. [アプリケーション起動手順](#アプリケーション起動手順)
5. [初期データとテストアカウント](#初期データとテストアカウント)
6. [動作確認](#動作確認)
7. [トラブルシューティング](#トラブルシューティング)
8. [開発環境の設定](#開発環境の設定)

---

## 必要な環境・ツール

### 必須ソフトウェア

| ソフトウェア | 推奨バージョン | 用途 |
|-------------|---------------|------|
| .NET SDK | 8.0 以上 | バックエンドAPI開発 |
| Node.js | 18.x 以上 | フロントエンド開発 |
| Git | 最新版 | ソースコード管理 |

### 推奨IDE・エディタ

| IDE/エディタ | 用途 | 備考 |
|-------------|------|------|
| Visual Studio 2022 | フルスタック開発 | Community版で十分 |
| Visual Studio Code | 軽量開発 | 拡張機能が豊富 |

### 推奨ブラウザ

- Google Chrome（開発者ツールが優秀）
- Microsoft Edge
- Firefox

---

## 環境構築手順

### 1. .NET SDK のインストール

1. [Microsoft .NET ダウンロードページ](https://dotnet.microsoft.com/download)にアクセス
2. **.NET 8.0 SDK** をダウンロード・インストール
3. インストール確認：
   ```bash
   dotnet --version
   ```
   > 8.0.x が表示されればOK

### 2. Node.js のインストール

1. [Node.js 公式サイト](https://nodejs.org/)にアクセス
2. **LTS版（推奨版）** をダウンロード・インストール
3. インストール確認：
   ```bash
   node --version
   npm --version
   ```
   > Node.js: v18.x 以上、npm: 9.x 以上が表示されればOK

### 3. Git のインストール

1. [Git 公式サイト](https://git-scm.com/)からダウンロード・インストール
2. インストール確認：
   ```bash
   git --version
   ```

### 4. IDE のインストール（推奨）

#### Visual Studio 2022 Community の場合
1. [Visual Studio ダウンロードページ](https://visualstudio.microsoft.com/ja/downloads/)にアクセス
2. **Community版（無料）** をダウンロード・インストール
3. インストール時に以下のワークロードを選択：
   - **ASP.NET と Web 開発**
   - **Node.js 開発**

#### Visual Studio Code の場合
1. [VS Code ダウンロードページ](https://code.visualstudio.com/)からダウンロード・インストール
2. 推奨拡張機能をインストール（後述）

---

## プロジェクトセットアップ

### 1. リポジトリのクローン

```bash
# プロジェクトをクローン
git clone https://github.com/dexit00/ClineDemo.git

# プロジェクトディレクトリに移動
cd ClineDemo
```

### 2. バックエンド（ASP.NET Core API）のセットアップ

```bash
# ECShop.APIディレクトリに移動
cd ECShop.API

# NuGetパッケージの復元
dotnet restore

# データベースの作成・マイグレーション実行
dotnet ef database update

# ビルド確認
dotnet build
```

### 3. フロントエンド（Vue.js）のセットアップ

```bash
# frontendディレクトリに移動
cd ../frontend

# npm パッケージのインストール
npm install

# ビルド確認
npm run build
```

---

## アプリケーション起動手順

### 方法1: 個別起動（推奨）

#### バックエンドAPI起動
```bash
# ECShop.APIディレクトリで実行
cd ECShop.API
dotnet run
```
> **起動確認**: `https://localhost:5001` または `http://localhost:5000` でSwagger UIが表示される

#### フロントエンド起動
```bash
# frontendディレクトリで実行（別ターミナル）
cd frontend
npm run serve
```
> **起動確認**: `http://localhost:8080` でECShopアプリケーションが表示される

### 方法2: Visual Studio での起動

1. `ECShop.sln` をVisual Studioで開く
2. ソリューションエクスプローラーで **ECShop.API** を右クリック
3. **「スタートアッププロジェクトに設定」** を選択
4. **F5キー** または **「デバッグの開始」** でAPI起動
5. 別ターミナルで `cd frontend && npm run serve` でフロントエンド起動

### 方法3: VS Code での起動

1. プロジェクトルートをVS Codeで開く
2. **ターミナル** → **新しいターミナル** を2つ開く
3. 1つ目のターミナル：
   ```bash
   cd ECShop.API
   dotnet run
   ```
4. 2つ目のターミナル：
   ```bash
   cd frontend
   npm run serve
   ```

---

## 初期データとテストアカウント

### データベース初期化

初回起動時、以下の初期データが自動的に作成されます：

#### テストユーザーアカウント

| ユーザー名 | パスワード | 権限 | 用途 |
|-----------|----------|------|------|
| `admin` | `admin123` | 管理者 | 管理機能テスト |
| `user1` | `user123` | 一般ユーザー | 購入機能テスト |
| `user2` | `user123` | 一般ユーザー | 複数ユーザーテスト |

#### サンプル商品データ

- **ノートパソコン**: ¥89,800
- **ワイヤレスマウス**: ¥2,980
- **キーボード**: ¥5,480
- **モニター**: ¥24,800
- **スマートフォン**: ¥78,800

#### サンプルお知らせデータ

- **重要**: システムメンテナンスのお知らせ
- **一般**: 新商品入荷のご案内
- **キャンペーン**: 春の特別セール開催中

### 手動でのデータリセット

データベースを初期状態に戻したい場合：

```bash
cd ECShop.API

# データベース削除
dotnet ef database drop

# マイグレーション再実行
dotnet ef database update
```

---

## 動作確認

### 1. バックエンドAPI確認

1. ブラウザで `https://localhost:5001/swagger` にアクセス
2. Swagger UIが表示されることを確認
3. **GET /api/products** を実行してサンプル商品が取得できることを確認

### 2. フロントエンド確認

1. ブラウザで `http://localhost:8080` にアクセス
2. ECShopのトップページが表示されることを確認
3. 商品一覧が表示されることを確認

### 3. 認証機能確認

1. **「ログイン」** ボタンをクリック
2. テストアカウント（`admin` / `admin123`）でログイン
3. ログイン後、ユーザー名が表示されることを確認
4. 管理者の場合、**「管理者ダッシュボード」** が表示されることを確認

### 4. お知らせ機能確認

1. ナビゲーションバーの **「お知らせ」** をクリック
2. お知らせ一覧が表示されることを確認
3. 管理者でログインしている場合、**「新規作成」** ボタンが表示されることを確認

### 5. 商品検索・フィルタ確認

1. 検索ボックスに商品名を入力
2. 検索結果が正しく表示されることを確認
3. 価格フィルタが動作することを確認

---

## トラブルシューティング

### よくある問題と解決方法

#### 1. ポート競合エラー

**症状**: `Port 5000 is already in use` などのエラー

**解決方法**:
```bash
# 使用中のポートを確認
netstat -ano | findstr :5000

# プロセスを終了（Windows）
taskkill /PID <プロセスID> /F

# または、別のポートを使用
dotnet run --urls="https://localhost:5002;http://localhost:5001"
```

#### 2. データベース接続エラー

**症状**: `Unable to connect to database` エラー

**解決方法**:
```bash
# マイグレーション状態確認
dotnet ef migrations list

# データベース再作成
dotnet ef database drop
dotnet ef database update
```

#### 3. npm インストールエラー

**症状**: `npm install` でエラーが発生

**解決方法**:
```bash
# キャッシュクリア
npm cache clean --force

# node_modules削除後再インストール
rm -rf node_modules package-lock.json
npm install
```

#### 4. CORS エラー

**症状**: フロントエンドからAPIアクセス時にCORSエラー

**解決方法**:
- `ECShop.API/Program.cs` でCORS設定を確認
- フロントエンドのURLが許可されているか確認
- ブラウザのキャッシュをクリア

#### 5. SSL証明書エラー

**症状**: `SSL certificate problem` エラー

**解決方法**:
```bash
# 開発用証明書の信頼
dotnet dev-certs https --trust
```

### ログの確認方法

#### バックエンドログ
- コンソール出力を確認
- `ECShop.API/logs/` フォルダ（設定されている場合）

#### フロントエンドログ
- ブラウザの開発者ツール → Console タブ
- Network タブでAPIリクエスト/レスポンスを確認

---

## 開発環境の設定

### Visual Studio Code 推奨拡張機能

#### C# 開発用
- **C# Dev Kit** - C#開発サポート
- **C#** - C#言語サポート
- **NuGet Package Manager** - NuGetパッケージ管理

#### Vue.js 開発用
- **Vue Language Features (Volar)** - Vue.js言語サポート
- **TypeScript Vue Plugin (Volar)** - TypeScript + Vue.js
- **Vue VSCode Snippets** - Vueスニペット

#### 汎用開発ツール
- **GitLens** - Git機能拡張
- **Prettier** - コードフォーマッター
- **ESLint** - JavaScript/TypeScriptリンター
- **Auto Rename Tag** - HTMLタグ自動リネーム
- **Bracket Pair Colorizer** - 括弧の色分け

### デバッグ設定

#### VS Code デバッグ設定（.vscode/launch.json）

```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": ".NET Core Launch (web)",
      "type": "coreclr",
      "request": "launch",
      "preLaunchTask": "build",
      "program": "${workspaceFolder}/ECShop.API/bin/Debug/net8.0/ECShop.API.dll",
      "args": [],
      "cwd": "${workspaceFolder}/ECShop.API",
      "stopAtEntry": false,
      "serverReadyAction": {
        "action": "openExternally",
        "pattern": "\\bNow listening on:\\s+(https?://\\S+)"
      },
      "env": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      },
      "sourceFileMap": {
        "/Views": "${workspaceFolder}/Views"
      }
    }
  ]
}
```

### 推奨設定

#### VS Code settings.json
```json
{
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "emmet.includeLanguages": {
    "vue": "html"
  },
  "files.associations": {
    "*.vue": "vue"
  }
}
```

---

## 日常的な開発フロー

### 1. 開発開始時

```bash
# 最新コードを取得
git pull origin main

# 依存関係更新（必要に応じて）
cd ECShop.API && dotnet restore
cd ../frontend && npm install

# アプリケーション起動
# ターミナル1: cd ECShop.API && dotnet run
# ターミナル2: cd frontend && npm run serve
```

### 2. 開発中

- **ホットリロード**: コード変更時に自動的に反映される
- **デバッグ**: ブレークポイントを設定してステップ実行
- **ログ確認**: コンソール出力とブラウザ開発者ツールを活用

### 3. 開発終了時

```bash
# 変更をコミット
git add .
git commit -m "機能追加: XXX機能を実装"
git push origin feature/xxx
```

---

## 参考リンク

### 公式ドキュメント
- [ASP.NET Core ドキュメント](https://docs.microsoft.com/ja-jp/aspnet/core/)
- [Vue.js ガイド](https://v3.ja.vuejs.org/guide/)
- [Entity Framework Core](https://docs.microsoft.com/ja-jp/ef/core/)

### 開発ツール
- [Visual Studio](https://visualstudio.microsoft.com/ja/)
- [Visual Studio Code](https://code.visualstudio.com/)
- [Postman](https://www.postman.com/) - API テストツール

---

## 更新履歴

| 日付 | バージョン | 更新内容 |
|------|-----------|----------|
| 2024/08/12 | 1.0.0 | 初版作成 |

---

## サポート

質問や問題が発生した場合は、以下の方法でサポートを受けることができます：

1. **チーム内での相談**: 先輩開発者に直接質問
2. **ドキュメント確認**: 本手順書および設計書を再確認
3. **ログ確認**: エラーメッセージとログを詳細に確認
4. **GitHub Issues**: プロジェクトのIssuesページで報告

---

**Happy Coding! 🚀**
